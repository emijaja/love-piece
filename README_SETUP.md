# Gemini API セットアップガイド

このアプリケーションでは、Google の Gemini API を使用して画像から感謝の文章を自動生成します。

## 1. API キーの取得

1. [Google AI Studio](https://aistudio.google.com/app/apikey) にアクセス
2. Google アカウントでログイン
3. 「Create API Key」をクリック
4. 生成された API キーをコピー

## 2. 環境変数の設定

1. プロジェクトルートに `.env.local` ファイルを作成:

```bash
cp .env.local.example .env.local
```

2. `.env.local` ファイルを開いて、API キーを設定:

```bash
GEMINI_API_KEY=あなたのAPIキーをここに貼り付け
```

3. ファイルを保存

**重要**: `.env.local` ファイルは Git にコミットされません（`.gitignore` で除外済み）

## 3. 依存関係のインストール

```bash
npm install
```

## 4. 開発サーバーの起動

```bash
npm run dev
```

サーバーが起動したら、ブラウザで http://localhost:3000 にアクセスします。

## 5. 動作確認

### 基本フロー

1. **画像の選択**
   - サンプル画像をクリック、または自分の画像をアップロード

2. **トーンの選択**
   - カジュアル、フォーマル、詩的の中から選択

3. **文章の生成**
   - 「文章を生成する」ボタンをクリック
   - 数秒後に結果ページに遷移

4. **結果の確認**
   - 生成された感謝の文章が表示されます
   - 「文章をコピー」で文章をクリップボードにコピー可能
   - 「文章を再生成」で別の文章を生成可能

## トラブルシューティング

### エラー: "APIキーが設定されていません"

**原因**: 環境変数が正しく設定されていない

**解決方法**:
1. `.env.local` ファイルがプロジェクトルートに存在することを確認
2. ファイル名が `.env.local` であることを確認（`.env` ではない）
3. ファイル内の `GEMINI_API_KEY=` の後に API キーが設定されていることを確認
4. 開発サーバーを再起動: `Ctrl+C` で停止してから `npm run dev` で再起動

### エラー: "AI による文章生成に失敗しました"

**原因**: API キーが無効、またはネットワークエラー

**解決方法**:
1. API キーが正しくコピーされているか確認
2. [Google AI Studio](https://aistudio.google.com/app/apikey) で API キーが有効か確認
3. インターネット接続を確認
4. Gemini API の利用制限に達していないか確認
   - 無料枠: 1分あたり15リクエスト

### 画像がアップロードできない

**原因**: ファイルサイズが大きすぎる、またはサポートされていない形式

**解決方法**:
1. 画像サイズを小さくする（推奨: 5MB 以下）
2. サポートされている形式を使用: JPEG, PNG, GIF
3. 画像を圧縮ツールで最適化

### 文章が生成されるのが遅い

**原因**: 画像サイズが大きい、またはネットワークが遅い

**解決方法**:
1. 画像サイズを小さくする
2. 画像を圧縮する
3. ネットワーク接続を確認

## API 使用量について

### 無料枠の制限（2025年1月時点）

Gemini 1.5 Flash モデルの無料枠:
- **リクエスト数**: 1分あたり15リクエスト、1日あたり1,500リクエスト
- **トークン数**: 月あたり100万トークン

### コスト最適化のヒント

1. **画像サイズの最適化**: 大きな画像は圧縮してからアップロード
2. **適切なモデル選択**: 現在は `gemini-1.5-flash` を使用（最も効率的）
3. **無駄なリクエストを避ける**: 同じ画像で何度も生成する場合は、結果を保存

## トーンの違い

### カジュアル
- 親しい友人や家族に向けた温かい表現
- 「いつもありがとう」「一緒にいてくれて嬉しい」など

### フォーマル
- 目上の方や改まった場面での丁寧な表現
- 「お世話になっております」「心より感謝申し上げます」など

### 詩的
- 詩のような美しい表現で深い感情を込めた文章
- 比喩や情景描写を織り交ぜた芸術的な表現

## 技術スタック

- **Next.js 14** (App Router)
- **TypeScript**
- **Tailwind CSS**
- **Gemini API** (Google)

## 開発者向け情報

### API エンドポイント

- `POST /api/generate-text`
  - リクエスト: `{ imageData: string, tone: 'casual' | 'formal' | 'poetic' }`
  - レスポンス: `{ text: string, tone: string }`

### プロジェクト構造

```
app/
├── api/
│   └── generate-text/
│       └── route.ts          # Gemini API との通信
├── page.tsx                  # 画像アップロード & トーン選択
├── result/
│   └── page.tsx             # 結果表示 & 再生成
├── layout.tsx
└── globals.css
```

## サポート

問題が解決しない場合は、以下を確認してください:

1. [Next.js ドキュメント](https://nextjs.org/docs)
2. [Gemini API ドキュメント](https://ai.google.dev/docs)
3. プロジェクトの README.md

---

作成日: 2026-02-14
